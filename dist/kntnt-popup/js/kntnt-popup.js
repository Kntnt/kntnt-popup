!function(e,t,o,n){"use strict";if(void 0===o||void 0===n||!n.popups||!Array.isArray(n.popups))return void console.error("Kntnt Popup Critical Error: Essential dependencies (MicroModal or kntntPopupData) are missing or malformed. Halting script execution.");const r=n.popups,a="ontouchstart"in e||navigator.maxTouchPoints>0,i={},p={};let s=!1;const l=[],c="kntnt_popup_last_closed_",d={},u=e=>{"Escape"===e.key&&(e.preventDefault(),e.stopPropagation())},m=(e,t)=>{if(t<=0)return!0;const o=`${c}${e}`,n=localStorage.getItem(o);if(!n)return!0;return Date.now()>=parseInt(n,10)+1e3*t},f=(e,o)=>{try{const n=new CustomEvent(e,{detail:{popupId:o},bubbles:!0,cancelable:!0});t.dispatchEvent(n)}catch(t){console.error(`Kntnt Popup: Error dispatching event ${e}`,t)}},g=(e,t,o,n)=>{const r=o[`${n}Animation`],a=`--kntnt-popup-${n}-duration`;if(r){const i=((e,t,o=null)=>{const n=t[`${e}AnimationDuration`];if("number"==typeof n&&n>=0)return n;if(o)try{const t=`--kntnt-popup-${e}-duration-default`,n=getComputedStyle(o).getPropertyValue(t),r=parseInt(n,10);if(!isNaN(r)&&r>=0)return r}catch(t){console.warn(`Kntnt Popup: Could not read CSS variable for ${e} duration.`,t)}return"open"===e?300:200})(n,o,t);e.dataset[`${n}Animation`]=r,t.style.setProperty(a,`${i}ms`)}else e.removeAttribute(`data-${n}-animation`),t.style.removeProperty(a)},y=(e,n)=>{const r=t.getElementById(e);r&&!r.classList.contains("is-open")&&m(e,n.reappearDelay)&&(r.dataset.kntntTriggered="true",(e=>{i[e]&&(clearTimeout(i[e]),delete i[e]),p[e]&&(t.removeEventListener("scroll",p[e]),delete p[e])})(e),f("kntnt_popup:before_open",e),o.show(e,{onShow:o=>{if(!o)return;const r=o.querySelector(".kntnt-popup__dialog");r&&(g(o,r,n,"open"),o.removeAttribute("data-close-animation"),r.style.removeProperty("--kntnt-popup-close-duration"),n.closeEscKey||(t.addEventListener("keydown",u,!0),d[e]=!0),f("kntnt_popup:after_open",e))},onClose:o=>{if(!o)return;(e=>{const t=`${c}${e}`;localStorage.setItem(t,Date.now().toString())})(e);const r=o.querySelector(".kntnt-popup__dialog");d[e]&&(t.removeEventListener("keydown",u,!0),delete d[e]),r?(g(o,r,n,"close"),o.removeAttribute("data-open-animation"),r.style.removeProperty("--kntnt-popup-open-duration"),f("kntnt_popup:after_close",e)):f("kntnt_popup:after_close",e)},openTrigger:"data-popup-open",closeTrigger:"data-popup-close",openClass:"is-open",disableScroll:n.isModal,awaitOpenAnimation:!!n.openAnimation,awaitCloseAnimation:!!n.closeAnimation,disableFocus:!n.isModal,debugMode:!1}))};r.forEach((o=>{const{instanceId:n,...r}=o,a=t.getElementById(n);a?m(n,r.reappearDelay)&&(((e,t,o)=>{if(!1!==t.showAfterTime&&t.showAfterTime>=0){const n=1e3*t.showAfterTime,r=()=>{!o.dataset.kntntTriggered&&m(e,t.reappearDelay)&&y(e,t)};0===n?setTimeout(r,0):i[e]=setTimeout(r,n)}})(n,r,a),((o,n,r)=>{if(!1!==n.showAfterScroll&&n.showAfterScroll>=0){const a=()=>{if(r.dataset.kntntTriggered||!m(o,n.reappearDelay))return void(p[o]&&(t.removeEventListener("scroll",a),delete p[o]));const i=t.documentElement.scrollHeight,{innerHeight:s}=e,{scrollY:l}=e;let c=0;i>s?c=l/(i-s)*100:0===n.showAfterScroll&&(c=100),c>=n.showAfterScroll&&(y(o,n),t.removeEventListener("scroll",a),delete p[o])};p[o]=a,t.addEventListener("scroll",a,{passive:!0}),a()}})(n,r,a),((e,t)=>{t.showOnExitIntent&&l.push({popupId:e,config:t})})(n,r)):console.warn(`Kntnt Popup: Element with ID #${n} not found. Skipping initialization.`)})),(()=>{if(l.length>0&&!a&&!s){let e;const o=o=>{o.clientY<=0&&(clearTimeout(e),e=setTimeout((()=>{const e=l.find((e=>{const o=t.getElementById(e.popupId);return o&&!o.dataset.kntntTriggered&&m(e.popupId,e.config.reappearDelay)}));e&&y(e.popupId,e.config)}),100))};t.documentElement.addEventListener("mouseleave",o),s=!0}})(),t.addEventListener("DOMContentLoaded",(()=>{t.querySelectorAll("[data-popup-open]").forEach((e=>{e.addEventListener("click",(o=>{o.preventDefault();const n=e.getAttribute("data-popup-open");if(n){const e=r.find((e=>e.instanceId===n));if(e){const o=t.getElementById(n);o&&!o.classList.contains("is-open")&&m(n,e.reappearDelay)?y(n,e):o&&!m(n,e.reappearDelay)&&console.warn(`Kntnt Popup [${n}]: Click trigger blocked by reappear delay.`)}else console.warn(`Kntnt Popup: Config not found for popup ID "${n}" triggered by click.`)}}))}))}))}(window,document,window.MicroModal,window.kntntPopupData);